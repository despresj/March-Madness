---
title: "March Madness Basketball Turniment"
author: "Sabrina Ball and Joe Despres"
date: "updated: `r Sys.Date()`"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

background-image: url(https://upload.wikimedia.org/wikipedia/en/2/28/March_Madness_logo.svg)
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.width = 6, echo = FALSE, message = FALSE, warning = FALSE, comment = "", cache = F)

library(tidyverse)
library(kableExtra)
library(patchwork)

merged <- readr::read_csv(here::here("data", "merged.csv"))
ids <- readr::read_csv(here::here("data", "ids.csv"))
s2021 <- readr::read_csv(here::here("data", "s2021.csv"))
source(here::here("R", "fitting.R"))
```

<!-- --- -->
<!-- # Backround on the turniment -->
<!-- quick facts... -->

<!-- --- -->

<!-- ![](images/empty_bracket.jpg) -->

<!-- --- -->
<!-- class: center, middle -->
<!-- # Zoomed in -->

<!-- ![](images/zoomed.png) -->

<!-- --- -->
<!-- # Goal -->
<!-- Can we use basketball seasion data to predict this turniment outcomes? -->

---

# Training Data

```{r}
descriptive_statistics <- function(x){
  output <- c(mean(x), median(x), sd(x), min(x), max(x))
  output <- round(output, digits = 2)
  return(output)
}


desc_stats <- merged %>% 
  select(fg_percent, ft_percent, rpg,st, to, bkpg) %>% 
  map_df(descriptive_statistics) %>% 
  t()

colnames(desc_stats) <- c("Mean", "Median", "Standard DEv", "Min", "Max")
rownames(desc_stats) <- c("Field Goal Percentage", "Free Throw Percentage", "Rebounds Per Game", "Steals", "Turnovers", "Blocked Shots Per Game")

kable(desc_stats) %>%
  kable_styling(bootstrap_options = c("striped", "hover")) 
```

---
class: center

# Distribution of Predictors

```{r fig.width=15, fig.height=10}
hists <- merged %>% 
  select(x3fg, fg_percent, rpg, st, to,  bkpg)

histogram <- function(x, t){
  ggplot(data = hists, aes(x)) + 
    geom_histogram(bins = 50, color = "black", fill = "gray80") + 
    theme_light(base_size = 20) + 
    labs(title = paste0("", t), x = "", y = "") + 
    NULL
    
}

a <- histogram(merged$x3fg,       t = "Three-Points Goals")
b <- histogram(merged$fg_percent, t = "Percentage of Goals Scored")
c <- histogram(merged$rpg,        t = "Rebounds Per Game")
d <- histogram(merged$st,         t = "Steals Per Game")
e <- histogram(merged$to,         t = "Turnovers Per Game")
f <- histogram(merged$bkpg,       t = "Blocks Per game")
# (a + b + c) / (d + e + f)
(a + b) / (c + d) /(e + f)
```


---

# Model

```{r}

equatiomatic::extract_eq(model = logistic_fit, 
                         use_coefs = FALSE, 
                         show_distribution = TRUE, 
                         wrap = TRUE, 
                         terms_per_line = 2, 
                         intercept = "beta")
# results='asis' in code chunk to render as LaTex
```

---

```{r}

equatiomatic::extract_eq(model = fit_poisson, 
                         use_coefs = FALSE, 
                         show_distribution = TRUE, 
                         wrap = TRUE, 
                         terms_per_line = 2, 
                         intercept = "beta")
```
---

# Results

```{r}
# require(memisc)
# mtable('Model 1' = logistic_fit,
#             'Model 2' = fit_poisson,
#             summary.stats = c('R-squared','F','p','N'), )

```




